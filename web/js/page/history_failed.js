function getTableData(e,a,t){var r={totalPage:0,totalCount:0,list:null};return $.ajax({type:"GET",async:!1,url:e+"/push/failure",headers:{"Content-Type":"application/json",token:a},data:{page:t.page,size:t.size,companyName:t.unit_name,beginTime:t.start_date,endTime:t.end_date},dataType:"json",success:function(e){if(console.log(e),"200"==e.code){if(r.totalPage=e.data.totalPage,r.totalCount=e.data.totalCount,e.data.list.length>0){r.list=e.data.list;for(var a=0;a<r.list.length;a++)r.list[a].pushTime=common().getFormateDate(r.list[a].pushTime)}}else console.log(e.code)},error:function(e){console.log(e)}}),r}function getPageData(e,a){var t={};t.index=e+1,1==t.index?t.prev=!1:t.prev=!0,t.index==a?t.next=!1:t.next=!0,t.pagers=[];var r=5*Math.ceil(t.index/5),n=a<r?a:r,s=n-4;for(s<=0&&(s=1),s;s<=n;s++)t.pagers.push(s);return t}function getToken(){var e=(new Cookies).getChild("md_user","token");if(null!=e&&""!=e)return e;window.location.href="login.html"}$(function(){url="http://47.92.68.88:88/server",new Vue({el:"#history",data:{user:{username:"",token:"",role:"",id:0},search:{page:0,size:10,start_date:"",end_date:"",unit_name:""},data:{totalPage:0,totalCount:0,list:null},pagers:{index:1,prev:!1,next:!0,pagers:[1,2,3,4,5]}},methods:{searchList:function(){var e=this;e.user.token=getToken();var a=""==$("#start-date").val()?e.search.start_date:$("#start-date").val(),t=""==$("#end-date").val()?e.search.end_date:$("#end-date").val(),r=$.trim($("#unit-name").val());e.search.start_date=a,e.search.end_date=t,e.search.unit_name=r,e.search.page=0,e.data=getTableData(url,e.user.token,e.search),e.pagers=getPageData(e.search.page,e.data.totalPage)},prev:function(){var e=this;e.user.token=getToken(),e.search.page--,e.pagers=getPageData(e.search.page,e.data.totalPage),e.data=getTableData(url,e.user.token,e.search)},next:function(){var e=this;e.user.token=getToken(),e.search.page++,e.pagers=getPageData(e.search.page,e.data.totalPage),e.data=getTableData(url,e.user.token,e.search)},goto:function(e){var a=this;a.user.token=getToken(),null==e&&((e=parseInt($("#go-page").val()))>a.data.totalPage&&(e=a.data.totalPage),e<1&&(e=1),$("#go-page").val(e)),a.search.page=e-1,a.pagers=getPageData(a.search.page,a.data.totalPage),a.data=getTableData(url,a.user.token,a.search)}},created:function(){var e=this,a=new Cookies;e.user.username=a.getChild("md_user","username"),null!=e.user.username&&""!=e.user.username?(e.user.token=a.getChild("md_user","token"),e.user.role=a.getChild("md_user","role"),e.user.id=parseInt(a.getChild("md_user","userid"))):window.location.href="login.html",e.search.start_date=common().getBeforeDate(7),e.search.end_date=common().getDate(),e.data=getTableData(url,e.user.token,e.search),e.pagers=getPageData(e.search.page,e.data.totalPage)}})});