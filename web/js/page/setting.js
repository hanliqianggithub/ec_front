function validation(e){return!!/^\d{6,16}$/.test(e)}function getToken(){var e=(new Cookies).getChild("md_user","token");if(null!=e&&""!=e)return e;window.location.href="login.html"}$(function(){url="http://47.92.107.76/server",new Vue({el:"#settings",data:{user:{username:"",token:"",role:""}},methods:{submit:function(){var e=this;e.user.token=getToken();var n=$("#oldPassword"),i=$("#newPassword"),r=$("#anewPassword"),s=!0;""==$.trim(n.val())?(s=!1,n.parents(".group-inline").find(".group-inline-item .msg-wrong").removeClass("hidden")):n.parents(".group-inline").find(".group-inline-item .msg-wrong").addClass("hidden"),""==$.trim(i.val())?(s=!1,i.parents(".group-inline").find(".group-inline-item .msg-wrong").html("新密码不能为空").removeClass("hidden")):0==validation($.trim(i.val()))?(s=!1,i.parents(".group-inline").find(".group-inline-item .msg-wrong").html("密码为6-16位数字").removeClass("hidden")):i.parents(".group-inline").find(".group-inline-item .msg-wrong").addClass("hidden"),$.trim(i.val())!=$.trim(r.val())?(s=!1,i.parents(".group-inline").find(".group-inline-item .msg-wrong").removeClass("hidden")):i.parents(".group-inline").find(".group-inline-item .msg-wrong").addClass("hidden"),s&&$.ajax({type:"PUT",url:url+"/user/modifyPassword",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e.user.token},data:{oldPassword:$.trim(n.val()),newPassword:$.trim(i.val())},dataType:"json",success:function(e){"200"==e.code?($("#alert-modal .modal-body h2").html("密码修改成功"),$("#alert-modal").modal("show")):($("#alert-modal .modal-body h2").html(e.message),$("#alert-modal").modal("show"))},error:function(e){console.log(e)}})}},created:function(){var e=this,n=new Cookies;e.user.username=n.getChild("md_user","username"),null!=e.user.username&&""!=e.user.username?(e.user.token=n.getChild("md_user","token"),e.user.role=n.getChild("md_user","role")):window.location.href="login.html"}}),$("#oldPassword").focus(),$("#oldPassword").blur(function(){""==$.trim($(this).val())?$(this).parents(".group-inline").find(".group-inline-item .msg-wrong").removeClass("hidden"):$(this).parents(".group-inline").find(".msg-wrong").addClass("hidden")}),$("#newPassword").blur(function(){""==$.trim($(this).val())?$(this).parents(".group-inline").find(".group-inline-item .msg-wrong").html("新密码不能为空").removeClass("hidden"):0==validation($(this).val())?$(this).parents(".group-inline").find(".group-inline-item .msg-wrong").html("密码为6-16位数字").removeClass("hidden"):$(this).parents(".group-inline").find(".msg-wrong").addClass("hidden")}),$("#anewPassword").blur(function(){$.trim($(this).val())!=$.trim($("#newPassword").val())?$(this).parents(".group-inline").find(".group-inline-item .msg-wrong").removeClass("hidden"):$(this).parents(".group-inline").find(".msg-wrong").addClass("hidden")}),$(".tab-title li").removeClass("current").eq(0).addClass("current"),$(".tab-content .tab-item").hide().eq(0).show(),$(".tab-title").delegate("li","click",function(){var e=$(this).index();$(".tab-title li").removeClass("current").eq(e).addClass("current"),$(".tab-content .tab-item").hide().eq(e).show()})});