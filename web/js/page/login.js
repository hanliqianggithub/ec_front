$(function(){$("#login-btn").click(function(){var o="http://47.92.107.76/server",e=$("#username"),n=$("#password"),t="";if(""==$.trim(e.val())?(t="用户名不能为空",e.focus()):""==$.trim(n.val())&&(t="密码不能为空",n.focus()),""!=t)$(".box .msg").html(t);else{var s=$.trim(e.val()),a=$.trim(n.val());$.ajax({type:"POST",url:o+"/login",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{account:s,password:a},dataType:"json",success:function(e){if("200"!=e.code)return $(".box .msg").html("用户名或密码不正确，请重新输入"),!1;$.ajax({type:"GET",url:o+"/user/info",headers:{token:e.data.token},dataType:"json",success:function(n){"200"==n.code&&$.ajax({type:"GET",url:o+"/refreshToken",headers:{token:e.data.token},dataType:"json",success:function(o){console.log(o),"200"==o.code&&((new Cookies).set("md_user","username="+n.data.name+"&userid="+n.data.id+"&token="+o.data.token+"&role="+n.data.roles[0].name,"s3500"),"manager"==n.data.roles[0].name?window.location.href="statistics.html":window.location.href="datalist.html")},error:function(o){console.log(o),$(".box .msg").html("请求失败，请联系管理员")}})},error:function(o){console.log(o),$(".box .msg").html("请求失败，请联系管理员")}})},error:function(o){console.log(o),$(".box .msg").html("请求失败，请联系管理员")}})}}),$(document).keydown(function(o){13===o.keyCode&&$("#login-btn").trigger("click")}),$("#username").focus(function(){$(this).parents(".input").addClass("input-focus")}),$("#username").blur(function(){$(this).parents(".input").removeClass("input-focus")}),$("#password").focus(function(){$(this).parents(".input").addClass("input-focus")}),$("#password").blur(function(){$(this).parents(".input").removeClass("input-focus")})});