function getData1(t,e){var n=null;return $.ajax({type:"GET",async:!1,url:t+"/contact/province",headers:{token:e},dataType:"json",success:function(t){"200"==t.code?n=t.data:console.log(t.code)},error:function(t){console.log(t)}}),n}function getData1_1(t,e,n,a){var o=null;return $.ajax({type:"GET",async:!1,url:t+"/contact/province",headers:{token:e},data:{begin:n,end:a},dataType:"json",success:function(t){"200"==t.code?o=t.data:console.log(t.code)},error:function(t){console.log(t)}}),o}function getData2(t,e,n,a){var o=null;return $.ajax({type:"GET",async:!1,url:t+"/contact/score",headers:{token:e},data:{begin:n,end:a},dataType:"json",success:function(t){"200"==t.code?null!=t.data&&(o=t.data):console.log(t.code)},error:function(t){console.log(t)}}),o}function getData3(t,e,n,a){var o=null;return $.ajax({type:"GET",async:!1,url:t+"/customer/saleState",headers:{token:e},data:{begin:n,end:a},dataType:"json",success:function(t){"200"==t.code?null!=t.data&&(o=t.data):console.log(t.code)},error:function(t){console.log(t)}}),o}function getDate(t,e){var n=1,a=new Date,o=a.getFullYear(),c=a.getMonth()+1;return t=parseInt(t),e=parseInt(e),t==o&&e==c?n=a.getDate():1==e||3==e||5==e||7==e||8==e||10==e||12==e?n=31:4==e||6==e||9==e||11==e?n=30:2==e&&(n=t%4==0&&t%100!=0||t%400==0?29:28),n}$(function(){url="http://47.92.107.76/server";var t=$(window).width(),e=$(window).height(),n=(t/1920).toFixed(6),a=(e/1080).toFixed(6);$(document.body).css("transform","scale("+n+","+a+")"),$(window).resize(function(){var t=$(window).width(),e=$(window).height(),n=(t/1920).toFixed(6),a=(e/1080).toFixed(6);$(document.body).css("transform","scale("+n+","+a+")")}),new Vue({el:"#dataview",data:{user:{username:"",token:"",role:"",id:0},search_time:"2017-12",data1:{totalCount:0,addCount:0},data3:{connectCount:{totalCount:0,percent:0},intentedCount:{totalCount:0,percent:0},clueCount:{totalCount:0,addCount:0},connected30Contact:[],connected60Contact:[],connected120Contact:[],connected240Contact:[]}},created:function(){var t=this,e=new Cookies;t.user.username=e.getChild("md_user","username"),null!=t.user.username&&""!=t.user.username?(t.user.token=e.getChild("md_user","token"),t.user.role=e.getChild("md_user","role"),t.user.id=parseInt(e.getChild("md_user","userid"))):window.location.href="login.html";var n=t.search_time+"-1",a=t.search_time+"-"+getDate(t.search_time.substring(0,4),t.search_time.substring(5,t.search_time.length)),o=getData1(url,t.user.token);if(null!=o){t.data1=o;var c=getData1_1(url,t.user.token,n,a);null!=c&&(t.data1.addCount=c.totalCount)}var r=getData3(url,t.user.token,n,a);if(null!=r){if(t.data3.connectCount.totalCount=r.connectedContact[3],t.data3.connectCount.percent=Math.round(r.totalConnectedContact[3]/r.totalContact[3]*100)+"%",t.data3.intentedCount.totalCount=r.intentedContact[3],t.data3.intentedCount.percent=Math.round(r.intentedContact[3]/r.totalContact[3]*100)+"%",t.data3.clueCount.totalCount=r.totalContact[3],t.data3.clueCount.addCount=r.addedContact[3],r.connected30Contact.length>0)for(s=0;s<r.connected30Contact.length;s++)t.data3.connected30Contact.push(r.connected30Contact[s]);if(r.connected60Contact.length>0)for(s=0;s<r.connected60Contact.length;s++)t.data3.connected60Contact.push(r.connected60Contact[s]);if(r.connected120Contact.length>0)for(s=0;s<r.connected120Contact.length;s++)t.data3.connected120Contact.push(r.connected120Contact[s]);if(r.connected240Contact.length>0)for(var s=0;s<r.connected240Contact.length;s++)t.data3.connected240Contact.push(r.connected240Contact[s]);var l=Math.round(100*r.connectedContactPercent[0])+"%";$("#connectCount-jishu h3").html(l),$("#connectCount-jishu .progressing").css("height",l);var i=Math.round(100*r.connectedContactPercent[2])+"%";$("#connectCount-shichang h3").html(i),$("#connectCount-shichang .progressing").css("height",i);var d=Math.round(100*r.connectedContactPercent[1])+"%";$("#connectCount-qita h3").html(d),$("#connectCount-qita .progressing").css("height",d);var u=Math.round(100*r.intentedContactPercent[0])+"%";$("#intentedCount-jishu h3").html(u),$("#intentedCount-jishu .progressing").css("height",u);var h=Math.round(100*r.intentedContactPercent[2])+"%";$("#intentedCount-shichang h3").html(h),$("#intentedCount-shichang .progressing").css("height",h);var m=Math.round(100*r.intentedContactPercent[1])+"%";$("#intentedCount-qita h3").html(m),$("#intentedCount-qita .progressing").css("height",m),$("#clueCount-jishu .progress-c1").css("width",Math.round(60*r.totalContactPercent[0])+"%"),$("#clueCount-jishu .progress-c2").css("width",Math.round(60*r.addedContactPercent[0])+"%"),$("#clueCount-shichang .progress-c1").css("width",Math.round(60*r.totalContactPercent[2])+"%"),$("#clueCount-shichang .progress-c2").css("width",Math.round(60*r.addedContactPercent[2])+"%"),$("#clueCount-qita .progress-c1").css("width",Math.round(60*r.totalContactPercent[1])+"%"),$("#clueCount-qita .progress-c2").css("width",Math.round(60*r.addedContactPercent[1])+"%")}}});var o=(new Cookies).getChild("md_user","token"),c={grid:{borderWidth:0},xAxis:[{type:"category",splitLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#008ff0"}},data:["10","20","30","40","50","60","70","80","90","100"]}],yAxis:[{type:"value",splitLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#008ff0"}}}],series:[{type:"line",smooth:!0,symbolSize:0,showSymbol:!1,itemStyle:{normal:{color:"#2c85d5",areaStyle:{type:"default",color:"rgba(44,133,213,.3)"}}},data:[0,0,0,0,0,0,0,0,0,0]}]},r=new echarts.init(document.getElementById("chart-bar-2"));r.setOption(c);var s=getData2(url,o,"2017-12-1","2017-12-31");null!=s&&r.setOption({series:[{data:s}]});var l={calculable:!0,grid:{borderWidth:0},xAxis:[{type:"value",axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1}}],yAxis:[{type:"category",axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#008ff0"}},data:["北京市","北京市","北京市","北京市","北京市","北京市","北京市","北京市","北京市","北京市"]}],series:[{type:"bar",stack:"chart",z:3,barWidth:"15",barMaxWidth:"15",label:{normal:{show:!1}},itemStyle:{normal:{color:"#2c85d5"}},data:[1814,1814,1814,1814,1814,1814,1814,1814,1814,1814]},{type:"bar",stack:"chart",itemStyle:{normal:{color:"rgba(255,255,255,.1)"},emphasis:{color:"rgba(255,255,255,.1)"}},data:[0,0,0,0,0,0,0,0,0,0]}]},i=new echarts.init(document.getElementById("chart-bar-1"));i.setOption(l);var d={color:["#ffff00"],legend:{orient:"vertical",x:"left",itemWidth:0,textStyle:{color:"transparent"},data:["clue"]},dataRange:{min:0,max:2500,x:"left",y:"bottom",text:["高","低"],calculable:!0,color:["#2e2e58","#024cfd","#4fd4f8"],show:!1},series:[{name:"clue",type:"map",mapType:"china",hoverable:!1,roam:!1,itemStyle:{normal:{label:{textStyle:{color:"#ffffff",fontSize:16},show:!0}}},data:[{name:"北京",value:25500}],geoCoord:{110000:[116.46,39.92],120000:[117.2,39.13],130000:[114.48,38.03],140000:[112.53,37.87],150000:[111.65,40.82],210000:[123.38,41.8],220000:[125.35,43.88],230000:[126.63,45.75],310000:[121.48,31.22],320000:[118.78,32.04],330000:[120.19,30.26],340000:[117.27,31.86],350000:[119.3,26.08],360000:[115.89,28.68],370000:[117,36.65],410000:[113.65,34.76],420000:[114.31,30.52],430000:[113,28.21],440000:[113.23,23.16],450000:[108.33,22.84],460000:[110.35,20.02],500000:[106.54,29.59],510000:[104.06,30.67],520000:[106.71,26.57],530000:[102.73,25.04],540000:[91.11,29.97],610000:[108.95,34.27],620000:[103.73,36.03],630000:[101.74,36.56],640000:[106.27,38.47],650000:[87.68,43.77]}},{type:"map",mapType:"china",data:[],markLine:{smooth:!0,effect:{show:!0,scaleSize:1,period:20,color:"#fff",shadowBlur:10},itemStyle:{normal:{borderWidth:1,lineStyle:{type:"solid",shadowBlur:10}}},data:[[{name:"110000"},{name:"120000",value:0}],[{name:"110000"},{name:"310000",value:0}],[{name:"110000"},{name:"440000",value:0}],[{name:"110000"},{name:"320000",value:0}],[{name:"110000"},{name:"370000",value:0}],[{name:"110000"},{name:"230000",value:0}],[{name:"110000"},{name:"150000",value:0}],[{name:"110000"},{name:"530000",value:0}],[{name:"110000"},{name:"540000",value:0}],[{name:"110000"},{name:"650000",value:0}]]},markPoint:{symbol:"emptyCircle",symbolSize:6,effect:{show:!1,shadowBlur:0},itemStyle:{normal:{label:{show:!1}},emphasis:{label:{show:!1}}},data:[{name:"120000",value:0},{name:"310000",value:0},{name:"440000",value:0},{name:"320000",value:0},{name:"370000",value:0},{name:"230000",value:0},{name:"150000",value:0},{name:"530000",value:0},{name:"540000",value:0},{name:"650000",value:0}]}}]},u=new echarts.init(document.getElementById("chart-map-1"));u.setOption(d);var h=getData1(url,o);if(null!=h&&h.list.length>0){for(var m=[],g=[],C=[],p=9;p>=0;p--)m.push(h.list[p].name.substring(0,3)),g.push(h.list[p].count),C.push(h.list[0].count-h.list[p].count);i.setOption({yAxis:[{data:m}],series:[{data:g},{data:C}]});for(var f=[],v=0;v<h.list.length;v++){var y=h.list[v].name.substring(0,2);"内蒙"==y?y="内蒙古":"黑龙"==y&&(y="黑龙江");var w={name:y,value:h.list[v].count};f.push(w)}u.setOption({series:[{data:f}]})}});