function getDetails(e,t,a){var s={};return $.ajax({type:"GET",async:!1,url:e+"/contact/"+a,headers:{"Content-Type":"application/x-www-form-urlencoded",token:t},dataType:"json",success:function(e){"200"==e.code?(null!=(s=e.data).phone&&""!=s.phone&&(s.phone=s.phone.substring(0,s.phone.length-4)+"****"),null!=s.mobile&&""!=s.mobile&&(s.mobile=s.mobile.substring(0,s.mobile.length-4)+"****")):console.log(e.code)},error:function(e){console.log(e)}}),s}function getTableData(e,t,a){var s={totalPage:0,totalCount:0,list:null};return $.ajax({type:"GET",async:!1,url:e+"/push/success",headers:{"Content-Type":"application/json",token:t},data:a,dataType:"json",success:function(e){if("200"==e.code){if(s.totalPage=e.data.totalPage,s.totalCount=e.data.totalCount,e.data.list.length>0){s.list=e.data.list;for(var t=0;t<s.list.length;t++)s.list[t].createTime=common().getFormateDate(s.list[t].createTime),null!=s.list[t].lastContactTime&&""!=s.list[t].lastContactTime?s.list[t].lastContactTime=common().getFormateDate(s.list[t].lastContactTime):s.list[t].lastContactTime="--","0"==s.list[t].saleState?s.list[t].saleStateName="--":"1"==s.list[t].saleState?s.list[t].saleStateName="新入库":"2"==s.list[t].saleState?s.list[t].saleStateName="感兴趣":"3"==s.list[t].saleState?s.list[t].saleStateName="拜访/远程":"4"==s.list[t].saleState?s.list[t].saleStateName="需求匹配":"5"==s.list[t].saleState?s.list[t].saleStateName="合作成交":"6"==s.list[t].saleState&&(s.list[t].saleStateName="已放弃")}}else console.log(e.code)},error:function(e){console.log(e)}}),s}function getPageData(e,t){var a={};a.index=e+1,1==a.index?a.prev=!1:a.prev=!0,a.index==t?a.next=!1:a.next=!0,a.pagers=[];var s=5*Math.ceil(a.index/5),n=t<s?t:s,l=n-4;for(l<=0&&(l=1),l;l<=n;l++)a.pagers.push(l);return a}function getProvinceMap(){return{110000:"北京市",120000:"天津市",130000:"河北省",140000:"山西省",150000:"内蒙古自治区",210000:"辽宁省",220000:"吉林省",230000:"黑龙江省",310000:"上海市",320000:"江苏省",330000:"浙江省",340000:"安徽省",350000:"福建省",360000:"江西省",370000:"山东省",410000:"河南省",420000:"湖北省",430000:"湖南省",440000:"广东省",450000:"广西壮族自治区",460000:"海南省",500000:"重庆市",510000:"四川省",520000:"贵州省",530000:"云南省",540000:"西藏自治区",610000:"陕西省",620000:"甘肃省",630000:"青海省",640000:"宁夏回族自治区",650000:"新疆维吾尔自治区",710000:"台湾省",810000:"香港特别行政区",820000:"澳门特别行政区"}}function getVocationMap(){return{1:"IT/通信/电子/互联网",2:"金融业",3:"房地产/建筑业",4:"法律",5:"商业服务",6:"医疗/健康",7:"贸易/批发/零售/租赁业",8:"生产/加工/制造",9:"交通/运输/物流/仓储",10:"服务业",11:"体育/休闲/旅游/娱乐",12:"能源/矿产/环保",13:"政府/非盈利机构",14:"媒体",15:"教育",16:"农/林/牧/渔",17:"跨领域经营",18:"其他",19:"互联网/电子商务",20:"IT服务（系统/数据/维护）",21:"计算机硬件",22:"信息技术与服务",23:"计算机软件",24:"电子技术/半导体/集成电路",25:"网络设备",26:"计算机游戏",27:"空间科技",28:"网络安全",29:"纳米技术",30:"电信/通讯",32:"财经服务",33:"证券",34:"期货",35:"会计",36:"投资",37:"保险",38:"银行",39:"信托",40:"担保",41:"拍卖",42:"典当",43:"房地产",44:"建筑/建筑建材/建材",45:"工程",46:"家居",47:"建筑/室内设计",48:"装饰装潢",49:"物业管理",50:"商业中心",51:"土木工程",52:"法律援助",53:"法律服务",54:"专业咨询/服务（财会/法律人力资源等）",55:"管理咨询",56:"招聘/猎头",57:"人力资源",58:"市场推广/广告",59:"市场调研/市场研究",60:"翻译服务",61:"公关",62:"会务/活动服务/展会",63:"中介服务",64:"检验/检测/认证",65:"外包服务",66:"生物工程",67:"生物信息",68:"医院/医疗",69:"医药品",70:"医疗设备",71:"兽医",72:"健身",73:"心理健康",74:"中医",75:"快速消费品（饮料/烟酒）",76:"食品",77:"化妆品",78:"服装",79:"纺织",80:"皮革",81:"家具",82:"数码家电",83:"贸易/进出口",84:"零售/批发",85:"租赁服务",86:"奢侈品/珠宝",87:"航空/航天研究与制造",88:"仪器仪表及工业自动化",89:"加工制造（模具）",90:"加工制造（原料加工）",91:"纺织/皮革",92:"玻璃/陶瓷/混凝土",93:"造纸/木材",94:"包装/集装箱",95:"铁路",96:"大型设备/机电设备/重工业",97:"化工",98:"汽车/摩托车",99:"飞行航空/宇航",100:"收藏品/奢侈品",101:"礼品/玩具",102:"工艺美术",103:"水电煤供应",104:"交通/运输",105:"物流/快递/仓储",106:"医疗/医疗服务护理/美容/保健卫生服务",107:"宗教协会",108:"家政服务",109:"环保服务",110:"保安服务",111:"图书馆及博物馆",112:"信息服务",113:"旅游/度假",114:"酒店/餐饮",115:"娱乐业",116:"休闲度假/旅游",117:"餐饮业",118:"住宿业",119:"体育运动",120:"娱乐设备与服务",121:"矿产/采掘/冶炼",122:"能源",123:"石油",124:"石化",126:"电气",127:"电力",128:"水利",129:"环保",130:"政府机关",131:"公共事业（社会福利/社会保障等）",132:"地质勘查/勘探",133:"公共安全",134:"公益基金",135:"智囊团",136:"非盈利机构",137:"学术/科研",138:"慈善",139:"印刷",140:"文化艺术",141:"写作/编辑",142:"出版",143:"杂志",144:"报纸",145:"电影",146:"电视",147:"广播",148:"媒体设计制作",149:"互联网媒体",150:"义务教育",151:"高等教育",152:"教育管理",153:"教育研究",154:"林业",155:"农业",156:"牧业",157:"渔业"}}function getSizeMap(){return{1:"0-50人",2:"51-150人",3:"151-500人",4:"501-2000人",5:"2000人以上"}}function getToken(){var e=(new Cookies).getChild("md_user","token");if(null!=e&&""!=e)return e;window.location.href="login.html"}$(function(){url="http://47.92.68.88:88/server",new Vue({el:"#history",data:{user:{username:"",token:"",role:"",id:0},search:{page:0,size:10,companyName:"",beginTime:"",endTime:"",followUserIds:""},data:{totalPage:0,totalCount:0,list:null},pagers:{index:1,prev:!1,next:!0,pagers:[1,2,3,4,5]},detail:{},dataMapProvice:getProvinceMap(),dataMapVocation:getVocationMap(),dataMapSize:getSizeMap()},methods:{searchList:function(){var e=this;e.user.token=getToken();var t=""==$("#start-date").val()?e.search.start_date:$("#start-date").val(),a=""==$("#end-date").val()?e.search.end_date:$("#end-date").val(),s=$.trim($("#unit-name").val());e.search.beginTime=t,e.search.endTime=a,e.search.companyName=s,parseInt($("#saleState").val())>0?e.search.saleState=parseInt($("#saleState").val()):e.search.saleState=null,e.search.page=0,e.data=getTableData(url,e.user.token,e.search),e.pagers=getPageData(e.search.page,e.data.totalPage)},showDetail:function(e){var t=this,a=$("#"+e).find("td");t.user.token=getToken(),t.detail=getDetails(url,t.user.token,e),t.detail.createTime=a.eq(2).html(),t.detail.lastContactTime=a.eq(3).html(),t.detail.saleState=a.eq(4).find("span").html(),$("#data-detail").modal("show")},prev:function(){var e=this;e.user.token=getToken(),e.search.page--,e.pagers=getPageData(e.search.page,e.data.totalPage),e.data=getTableData(url,e.user.token,e.search)},next:function(){var e=this;e.user.token=getToken(),e.search.page++,e.pagers=getPageData(e.search.page,e.data.totalPage),e.data=getTableData(url,e.user.token,e.search)},goto:function(e){var t=this;t.user.token=getToken(),null==e&&((e=parseInt($("#go-page").val()))>t.data.totalPage&&(e=t.data.totalPage),e<1&&(e=1),$("#go-page").val(e)),t.search.page=e-1,t.pagers=getPageData(t.search.page,t.data.totalPage),t.data=getTableData(url,t.user.token,t.search)}},created:function(){var e=this,t=new Cookies;e.user.username=t.getChild("md_user","username"),null!=e.user.username&&""!=e.user.username?(e.user.token=t.getChild("md_user","token"),e.user.role=t.getChild("md_user","role"),e.user.id=parseInt(t.getChild("md_user","userid"))):window.location.href="login.html",e.search.beginTime=common().getBeforeDate(7),e.search.endTime=common().getDate(),e.search.followUserIds=t.getChild("md_user","userid"),e.data=getTableData(url,e.user.token,e.search),e.pagers=getPageData(e.search.page,e.data.totalPage)}})});